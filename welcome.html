<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>Welcome — Dumka</title>
  <meta name="description" content="Personalize your Dumka notebook" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="/assets/css/welcome.css" />
</head>
<body>

  <!-- Sticker cursor (follows mouse when sticker selected) -->
  <div id="sticker-cursor" class="sticker-cursor" aria-hidden="true"></div>

  <!-- ═══ PHASE 1: NOTEBOOK ═══ -->
  <section id="phase-notebook" class="phase active">
    <div class="notebook-scene">

      <!-- Notebook -->
      <div class="notebook" id="notebook">
        <div class="nb-wrapper">
          <!-- Back cover (visible when open) -->
          <div class="nb-back"></div>
          <!-- Pages -->
          <div class="nb-pages">
            <div class="nb-page"></div>
            <div class="nb-page"></div>
            <div class="nb-page"></div>
            <!-- Journal inscription appears after cover opens -->
            <div class="nb-journal-text" id="nb-journal-text"></div>
          </div>
          <!-- Front cover -->
          <div class="nb-cover" id="nb-cover">
            <div class="nb-spine"></div>
            <div class="nb-elastic"></div>
            <div class="nb-corner nb-corner-tr"></div>
            <div class="nb-corner nb-corner-br"></div>

            <!-- Editable title -->
            <div class="nb-title-area">
              <input
                type="text"
                id="nb-title"
                class="nb-title"
                value=""
                placeholder=""
                maxlength="20"
                spellcheck="false"
                autocomplete="off"
                aria-label="Your name"
                autofocus
              />
              <div class="nb-title-hint">your name</div>
            </div>

            <!-- Sticker slots (placed by clicking on cover) -->
            <div class="nb-stickers" id="nb-stickers"></div>
          </div>
        </div>
      </div>

      <!-- Sticker picker -->
      <div class="sticker-tray" id="sticker-tray">
        <div class="sticker-tray-label">Pick a sticker</div>
        <div class="sticker-tray-items">
          <button class="sticker-btn" data-sticker="star" data-color="#facc15" aria-label="Star sticker">
            <svg viewBox="0 0 32 32" width="28" height="28">
              <path d="M16 2l4.3 8.7L30 12l-7 6.8 1.6 9.6L16 24.2l-8.6 4.2L9 18.8 2 12l9.7-1.3z" fill="#facc15"/>
              <path d="M16 2l4.3 8.7L30 12l-7 6.8 1.6 9.6L16 24.2l-8.6 4.2L9 18.8 2 12l9.7-1.3z" fill="none" stroke="#eab308" stroke-width="1" stroke-linejoin="round"/>
              <path d="M16 7l2.6 5.3 5.8.8-4.2 4.1 1 5.8L16 20.2" fill="#fde047" opacity="0.6"/>
              <circle cx="13" cy="13" r="1" fill="#fff" opacity="0.5"/>
            </svg>
          </button>
          <button class="sticker-btn" data-sticker="heart" data-color="#f472b6" aria-label="Heart sticker">
            <svg viewBox="0 0 32 32" width="28" height="28">
              <path d="M16 28s-12-8.5-12-16a7 7 0 0 1 12-4.9A7 7 0 0 1 28 12c0 7.5-12 16-12 16z" fill="#f472b6"/>
              <path d="M16 28s-12-8.5-12-16a7 7 0 0 1 12-4.9A7 7 0 0 1 28 12c0 7.5-12 16-12 16z" fill="none" stroke="#ec4899" stroke-width="1" stroke-linejoin="round"/>
              <path d="M10 8a4.5 4.5 0 0 1 6 2" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round" opacity="0.5"/>
              <ellipse cx="11" cy="11" rx="2" ry="1.5" fill="#fff" opacity="0.25" transform="rotate(-20 11 11)"/>
            </svg>
          </button>
          <button class="sticker-btn" data-sticker="bolt" data-color="#60a5fa" aria-label="Lightning sticker">
            <svg viewBox="0 0 32 32" width="28" height="28">
              <polygon points="18,2 7,18 14,18 12,30 25,13 17,13 20,2" fill="#60a5fa"/>
              <polygon points="18,2 7,18 14,18 12,30 25,13 17,13 20,2" fill="none" stroke="#3b82f6" stroke-width="1" stroke-linejoin="round"/>
              <polygon points="17,5 11,15 15,15 14,22" fill="#93c5fd" opacity="0.5"/>
              <circle cx="20" cy="7" r="1.5" fill="#dbeafe" opacity="0.6"/>
              <circle cx="23" cy="4" r="0.8" fill="#dbeafe" opacity="0.4"/>
            </svg>
          </button>
          <button class="sticker-btn" data-sticker="coffee" data-color="#a78bfa" aria-label="Coffee sticker">
            <svg viewBox="0 0 32 32" width="28" height="28">
              <rect x="5" y="14" width="17" height="12" rx="3" fill="#a78bfa"/>
              <rect x="5" y="14" width="17" height="12" rx="3" fill="none" stroke="#8b5cf6" stroke-width="1"/>
              <path d="M22 17h2.5a3.5 3.5 0 0 1 0 7H22" fill="none" stroke="#8b5cf6" stroke-width="1.8" stroke-linecap="round"/>
              <rect x="7" y="16" width="4" height="8" rx="1.5" fill="#c4b5fd" opacity="0.4"/>
              <path d="M9 7c0-3 3-3 3 0s3 0 3-3" fill="none" stroke="#c4b5fd" stroke-width="1.5" stroke-linecap="round"/>
              <path d="M14 9c0-2.5 2.5-2.5 2.5 0" fill="none" stroke="#c4b5fd" stroke-width="1.3" stroke-linecap="round" opacity="0.7"/>
              <ellipse cx="13.5" cy="14" rx="6" ry="1" fill="#8b5cf6" opacity="0.15"/>
            </svg>
          </button>
          <button class="sticker-btn" data-sticker="rocket" data-color="#34d399" aria-label="Rocket sticker">
            <svg viewBox="0 0 32 32" width="28" height="28">
              <path d="M16 3c-5 5-7 12-7 18h14c0-6-2-13-7-18z" fill="#34d399"/>
              <path d="M16 3c-5 5-7 12-7 18h14c0-6-2-13-7-18z" fill="none" stroke="#10b981" stroke-width="1" stroke-linejoin="round"/>
              <path d="M12 18c-3 1-5 4-5 4l3-2m13-2c3 1 5 4 5 4l-3-2" fill="#34d399" stroke="#10b981" stroke-width="0.8" stroke-linejoin="round"/>
              <circle cx="16" cy="14" r="2.5" fill="#fff"/>
              <circle cx="16" cy="14" r="1.2" fill="#34d399"/>
              <path d="M13 5c1-1 2.5-1 3 0" fill="none" stroke="#6ee7b7" stroke-width="1.2" stroke-linecap="round" opacity="0.6"/>
              <rect x="13" y="22" width="6" height="4" rx="2" fill="#fdba74"/>
              <rect x="14.5" y="24" width="3" height="3" rx="1.5" fill="#f97316" opacity="0.7"/>
              <circle cx="11" cy="27" r="0.8" fill="#fdba74" opacity="0.5"/>
              <circle cx="21" cy="26" r="0.6" fill="#fdba74" opacity="0.4"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Continue button -->
      <button class="btn-continue" id="btn-notebook-done">Open notebook</button>
    </div>
  </section>

  <!-- ═══ PHASE 2: ONBOARDING (mini demo feed) ═══ -->
  <section id="phase-onboarding" class="phase">
    <div class="onboarding">

      <!-- Task instruction (above the demo) -->
      <div class="ob-instruction" id="ob-instruction">
        <div class="ob-step-badge" id="ob-step-badge">1 / 3</div>
        <h2 class="ob-step-title" id="ob-step-title">Create a task</h2>
        <p class="ob-step-desc" id="ob-step-desc">Start your note with <strong>[]</strong> to make it a task.<br/>Try typing: <em>[] Buy groceries</em></p>
      </div>

      <!-- Mini demo app (replicates real product) -->
      <div class="demo-app" id="demo-app">
        <div class="demo-feed" id="demo-feed">
          <!-- Notes appear here dynamically -->
        </div>

        <!-- Multi-action bar (for thread step) — matches .multi-action-bar -->
        <div class="demo-action-bar" id="demo-action-bar">
          <div class="demo-action-inner">
            <div class="demo-action-count" id="demo-action-count">Selected: 0</div>
            <div class="demo-action-buttons">
              <button class="demo-action-btn thread" id="demo-action-thread" disabled>Create thread</button>
            </div>
          </div>
        </div>

        <!-- Composer — matches .composer-wrap + .input-wrapper -->
        <div class="demo-composer" id="demo-composer">
          <div class="demo-input-wrapper" id="demo-input-wrapper">
            <textarea id="demo-input" class="demo-input" rows="1" placeholder="What's new?"></textarea>
            <button class="demo-send" id="demo-send" disabled aria-label="Send note">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Result message -->
      <div class="ob-result" id="ob-result"></div>

      <!-- Navigation -->
      <div class="ob-nav">
        <button class="ob-skip" id="ob-skip">Skip</button>
      </div>
    </div>
  </section>

  <!-- ═══ PHASE 3: WELCOME ═══ -->
  <section id="phase-welcome" class="phase">
    <div class="welcome-finale">
      <h1 class="wf-title">Welcome to Dumka</h1>
      <p class="wf-sub">Your notebook is ready.</p>
    </div>
  </section>

  <script src="/assets/js/supabaseclient.js"></script>
  <script src="/assets/js/welcome.js"></script>
</body>
</html>
